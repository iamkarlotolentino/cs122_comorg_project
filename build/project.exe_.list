EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
project.exe_ -- emu8086 assembler version: 4.08  
 
[ 04/04/2020  --  3:57:00 pm ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       
[   2]        :                                       include 'macros.inc'
[   3]        :                                       
[   4]        :                                       title "Bank Account Manager"
[   5]        :                                       
[   6]        :                                       .MODEL small
[   7]        :                                       .STACK 100h
[   8]        :                                       .DATA
[   9]    0100: 00                                    acct_login      db   0
[  10]    0101: 20 20 20 20 20 20 20 20 20 20 20 20   ff_card_no      db  16 dup(' '), '$'
                20 20 20 20 24                      
[  11]    0112: 20 20 20 20 20 20 20 24               ff_pin_code     db   7 dup(' '), '$'
[  12]    011A: 20 20 20 20 20 20 20 20 20 20 20 20   ff_balance      db  12 dup(' '), '$'
                24                                  
[  13]        :                                       
[  14]    0127: 11 00 24 24 24 24 24 24 24 24 24 24   in_card_no      db  17, ?, 17 dup('$')
                24 24 24 24 24 24 24                
[  15]    013A: 07 00 24 24 24 24 24 24 24            in_pin_code     db   7, ?,  7 dup('$')
[  16]    0143: 07 00 24 24 24 24 24 24 24            new_pin_code    db   7, ?,  7 dup('$')
[  17]        :                                       
[  18]    014C: 0D 00 20 20 20 20 20 20 20 20 20 20   input_amount    db  13, ?, 13 dup(' ')
                20 20 20                            
[  19]        :                                       
[  20]    015B: 61 63 63 6F 75 6E 74 2E 74 78 74 00   fname           db  "account.txt", 0
                                                    
[  21]    0167: 00 00                                 fhandle         dw  ?
[  22]    0169: 00 00 00 00 00 00 00 00 00 00 00 00   fbuffer         db  38 dup(?)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00                               
[  23]        :                                       
[  24]        :                                       ;  [0][1][2][3][4][5][6][7]
[  25]    018F: 00 00 00 00 00 00 00 00               page_buffer     db  0, 0, 0, 0, 0, 0, 0, 0
[  26]        :                                       
[  27]    0197: 54 69 6D 65 3A 24                     time            db  "Time:$"
[  28]    019D: 30 30 3A 30 30 3A 30 30 24            timestamp       db  "00:00:00$"
[  29]        :                                       ;   [0]   [1]   [2]   [3]   [4]   [5]   [6]   [7]   [8]   [9]   [10]  [11]
[  30]    01A6: B9 BA BB BC C8 C9 CA CB CC CD CE AF   _sym            db  185d, 186d, 187d, 188d, 200d, 201d, 202d, 203d, 204d, 205d, 206d, 175d
                                                    
[  31]        :                                       
[  32]    01B2: 57 65 6C 63 6F 6D 65 2C 20 4A 43 21   login_accnt     db "Welcome, JC!$"
                24                                  
[  33]    01BF: 59 6F 75 72 20 70 65 72 73 6F 6E 61   login_desc      db "Your personal bank acc't manager$"
                6C 20 62 61 6E 6B 20 61 63 63 27 74 
                20 6D 61 6E 61 67 65 72 24          
[  34]    01E0: 43 41 52 44 20 4E 4F 2E 24 50 49 4E   login_frm_text  db "CARD NO.$", "PIN CODE$"
                20 43 4F 44 45 24                   
[  35]    01F2: 5B 20 4F 4B 20 5D 24 5B 20 43 41 4E   login_frm_sel   db "[ OK ]$", "[ CANCEL ]$"
                43 45 4C 20 5D 24                   
[  36]        :                                       
[  37]    0204: 57 69 74 68 64 72 61 77 24 44 65 70   menu_frm_text   db  "Withdraw$", "Deposit$", "Balance$", "Reset PIN$", "Log Out$", "Details$"
                6F 73 69 74 24 42 61 6C 61 6E 63 65 
                24 52 65 73 65 74 20 50 49 4E 24 4C 
                6F 67 20 4F 75 74 24 44 65 74 61 69 
                6C 73 24                            
[  38]    0237: C9 CD CD CD CD CD CD CD CD CD CD CD   menu_hdr        db  201d, 15 dup(205d), 187d, '$'
                CD CD CD CD BB 24                   
[  39]    0249: C8 CD CD CD CD CD CD CD CD CD CD CD   menu_frm_ftr    db  200d, 15 dup(205d), 188d, '$'
                CD CD CD CD BC 24                   
[  40]        :                                       
[  41]    025B: 4E 4F 54 20 56 41 4C 49 44 20 49 4E   err_blank       db  "NOT VALID INPUT$"
                50 55 54 24                         
[  42]    026B: 49 6E 63 6F 72 72 65 63 74 21 20 54   err_incorrect   db  "Incorrect! Try again.$"
                72 79 20 61 67 61 69 6E 2E 24       
[  43]    0281: 45 72 72 6F 72 2E 20 41 63 63 6F 75   err_file404     db  "Error. Account database not found!$"
                6E 74 20 64 61 74 61 62 61 73 65 20 
                6E 6F 74 20 66 6F 75 6E 64 21 24    
[  44]        :                                       
[  45]    02A4: 45 6E 74 65 72 20 61 6D 6F 75 6E 74   input_text      db  "Enter amount:$"
                3A 24                               
[  46]    02B2: 4E 4F 54 45 3A 20 41 6D 6F 75 6E 74   input_note      db  "NOTE: Amount should be divisible by 20$"
                20 73 68 6F 75 6C 64 20 62 65 20 64 
                69 76 69 73 69 62 6C 65 20 62 79 20 
                32 30 24                            
[  47]        :                                       
[  48]    02D9: 54 68 61 6E 6B 20 79 6F 75 2E 20 47   exit_msg        db "Thank you. Goodbye!$"
                6F 6F 64 62 79 65 21 24             
[  49]    02ED: 54 65 6C 6C 65 72 20 4D 61 63 68 69   app_version     db "Teller Machine @ 2020 ", 179d, " v1.0$"
                6E 65 20 40 20 32 30 32 30 20 B3 20 
                76 31 2E 30 24                      
[  50]        :                                       .CODE
[  51]        :                                       ;---------------------- MAIN PROC -------------------------;
[  52]    0310:                                       main PROC
[  53]        :                                       ; initialize all proper data and setup
[  54]    0310: E8 41 00                              call           setup
[  55]    0313:                                       login:
[  56]    0313: E8 B3 00                              call           login_page
[  57]        :                                       ; evaluate if the input is valid
[  58]        :                                       ; pin-code not empty
[  59]    0316: 80 3E 3C 00 24                        cmp            in_pin_code[2], '$'
[  60]    031B: 74 13                                 je             login_error
[  61]        :                                       ; card-no not empty
[  62]    031D: 80 3E 29 00 24                        cmp            in_card_no[2], '$'
[  63]    0322: 74 0C                                 je             login_error
[  64]        :                                       ; validate acccount
[  65]    0324: E8 CD 06                              call           validate_acct
[  66]    0327: 80 3E 00 00 01                        cmp            acct_login, 01h
[  67]    032C: 75 E5                                 jne            login
[  68]    032E: EB 1F                                 jmp            continue
[  69]    0330:                                       login_error:
[  70]    0330: B6 0B B2 0D B7 06 B4 02 CD 10         cursor_at      11,13,6
[  71]    033A: B0 06 B4 05 CD 10 E8 5E 06 BA 5B 01   alert          err_blank
                B4 09 CD 21                         
[  72]    034A: E8 FF 06                              call           delay
[  73]    034D: EB C4                                 jmp            login
[  74]    034F:                                       continue:
[  75]    034F: E8 77 03                              call           menu_page
[  76]        :                                       ; expected logout has been called
[  77]    0352: EB BF                                 jmp            login
[  78]        :                                       main ENDP
[  79]        :                                       
[  80]        :                                       ;---------------------- SETUP PROC -------------------------;
[  81]    0354:                                       setup PROC
[  82]        :                                       ; data segment address
[  83]    0354: BA 10 00                              mov            dx, @data
[  84]    0357: 8E DA                                 mov            ds, dx
[  85]    0359: 8E C2                                 mov            es, dx
[  86]        :                                       
[  87]        :                                       ; set video mode
[  88]    035B: B0 00                                 mov            al, 00h
[  89]    035D: B4 00                                 mov            ah, 00h
[  90]    035F: CD 10                                 int            10h
[  91]        :                                       
[  92]        :                                       ; disable blinking
[  93]    0361: B8 03 10                              mov            ax, 1003h
[  94]    0364: BB 00 00                              mov            bx, 00h
[  95]    0367: CD 10                                 int            10h
[  96]        :                                       
[  97]        :                                       ; hide text cursor:
[  98]    0369: B5 32                                 mov            ch, 32h
[  99]    036B: B4 01                                 mov            ah, 01h
[ 100]    036D: CD 10                                 int            10h
[ 101]        :                                       
[ 102]        :                                       ; initialize mouse
[ 103]    036F: B8 00 00                              mov            ax, 00h
[ 104]    0372: CD 33                                 int            33h
[ 105]        :                                       
[ 106]        :                                       ; display mouse cursor:
[ 107]    0374: B8 01 00                              mov            ax, 01h
[ 108]    0377: CD 33                                 int            33h
[ 109]        :                                       
[ 110]        :                                       ; load account details
[ 111]        :                                       ; open file
[ 112]    0379: B0 02                                 mov            al, 02h
[ 113]    037B: BA 5B 00                              mov            dx, offset fname
[ 114]    037E: B4 3D                                 mov            ah, 3Dh
[ 115]    0380: CD 21                                 int            21h
[ 116]    0382: 72 3B                                 jc             fileerr
[ 117]    0384: A3 67 00                              mov            fhandle, ax
[ 118]        :                                       
[ 119]        :                                       ; read file
[ 120]    0387: 8B 1E 67 00                           mov            bx, fhandle
[ 121]    038B: B9 30 00                              mov            cx, 30h
[ 122]    038E: BA 69 00                              lea            dx, fbuffer
[ 123]    0391: B4 3F                                 mov            ah, 3Fh
[ 124]    0393: CD 21                                 int            21h
[ 125]        :                                       
[ 126]        :                                       ; parse data
[ 127]        :                                       ; first 16 bytes is acc't no.
[ 128]    0395: BE 68 00                              lea            si, [fbuffer-1]
[ 129]    0398: BF 01 00                              lea            di, ff_card_no
[ 130]    039B: B9 10 00                              mov            cx, 0010h
[ 131]    039E: 46                                    inc            si
[ 132]    039F: FC                                    cld
[ 133]    03A0: F3                                    rep
[ 134]    03A1: A4                                    movsb
[ 135]        :                                       ; next 6 bytes is pin code
[ 136]    03A2: 46                                    inc            si
[ 137]    03A3: BF 12 00                              lea            di, ff_pin_code
[ 138]    03A6: B9 06 00                              mov            cx, 0006h
[ 139]    03A9: 46                                    inc            si
[ 140]    03AA: FC                                    cld
[ 141]    03AB: F3                                    rep
[ 142]    03AC: A4                                    movsb
[ 143]        :                                       ; next 12 bytes is current balance
[ 144]    03AD: 46                                    inc            si
[ 145]    03AE: BF 1A 00                              lea            di, ff_balance
[ 146]    03B1: B9 0C 00                              mov            cx, 000Ch
[ 147]    03B4: 46                                    inc            si
[ 148]    03B5: FC                                    cld
[ 149]    03B6: F3                                    rep
[ 150]    03B7: A4                                    movsb
[ 151]        :                                       ; close file
[ 152]    03B8: B4 3E                                 mov            ah, 3Eh
[ 153]    03BA: 8B 1E 67 00                           mov            bx, fhandle
[ 154]    03BE: C3                                    ret
[ 155]    03BF:                                       fileerr:
[ 156]    03BF: BA 81 01 B4 09 CD 21                  prints         err_file404
[ 157]    03C6: E8 E6 05                              call           sys_exit
[ 158]        :                                       setup ENDP
[ 159]        :                                       
[ 160]        :                                       ;---------------------- LOGIN PAGE PROC -------------------------;
[ 161]    03C9:                                       login_page PROC
[ 162]    03C9: B0 00 B4 05 CD 10                     set_videopage  0
[ 163]        :                                       ; check if page has been loaded
[ 164]    03CF: 80 3E 8F 00 01                        cmp            page_buffer[0], 1
[ 165]    03D4: 75 03 E9 3D 02                        je             keep_listening
[ 166]    03D9: E8 C5 05                              call           cls
[ 167]        :                                       ; selection form printing
[ 168]    03DC: B6 03 B2 02 B7 00 B4 02 CD 10         cursor_at      3,2,0
[ 169]    03E6: 8A 16 AB 00 B4 02 CD 21               printc         _sym[5]
[ 170]    03EE: B5 00 B1 22 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],34
                E2 F6                               
[ 171]    03FC: 8A 16 A8 00 B4 02 CD 21               printc         _sym[2]
[ 172]        :                                       
[ 173]    0404: B6 04 B2 02 B7 00 B4 02 CD 10         cursor_at      4,2,0
[ 174]    040E: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 175]    0416: B6 04 B2 25 B7 00 B4 02 CD 10         cursor_at      4,37,0
[ 176]    0420: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 177]    0428: B6 04 B2 04 B7 00 B4 02 CD 10         cursor_at      4,4,0
[ 178]    0432: BA B2 00 B4 09 CD 21                  prints         login_accnt
[ 179]        :                                       
[ 180]    0439: B6 05 B2 02 B7 00 B4 02 CD 10         cursor_at      5,2,0
[ 181]    0443: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 182]    044B: B6 05 B2 25 B7 00 B4 02 CD 10         cursor_at      5,37,0
[ 183]    0455: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 184]    045D: B6 05 B2 04 B7 00 B4 02 CD 10         cursor_at      5,4,0
[ 185]    0467: BA BF 00 B4 09 CD 21                  prints         login_desc
[ 186]        :                                       
[ 187]    046E: B6 06 B2 02 B7 00 B4 02 CD 10         cursor_at      6,2,0
[ 188]    0478: 8A 16 AA 00 B4 02 CD 21               printc         _sym[4]
[ 189]    0480: B5 00 B1 22 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],34
                E2 F6                               
[ 190]    048E: 8A 16 A9 00 B4 02 CD 21               printc         _sym[3]
[ 191]        :                                       
[ 192]    0496: B6 08 B2 02 B7 00 B4 02 CD 10         cursor_at      8,2,0
[ 193]    04A0: 8A 16 AB 00 B4 02 CD 21               printc         _sym[5]
[ 194]    04A8: B5 00 B1 0C 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],12
                E2 F6                               
[ 195]    04B6: 8A 16 AD 00 B4 02 CD 21               printc         _sym[7]
[ 196]    04BE: B5 00 B1 15 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],21
                E2 F6                               
[ 197]    04CC: 8A 16 A8 00 B4 02 CD 21               printc         _sym[2]
[ 198]        :                                       
[ 199]    04D4: B6 09 B2 02 B7 00 B4 02 CD 10         cursor_at      9,2,0
[ 200]    04DE: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 201]    04E6: B6 09 B2 0F B7 00 B4 02 CD 10         cursor_at      9,15,0
[ 202]    04F0: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 203]    04F8: B6 09 B2 25 B7 00 B4 02 CD 10         cursor_at      9,37,0
[ 204]    0502: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 205]    050A: B6 09 B2 04 B7 00 B4 02 CD 10         cursor_at      9,4,0
[ 206]    0514: BA E0 00 B4 09 CD 21                  prints         login_frm_text[0]
[ 207]        :                                       
[ 208]    051B: B6 0A B2 02 B7 00 B4 02 CD 10         cursor_at      10,2,0
[ 209]    0525: 8A 16 AE 00 B4 02 CD 21               printc         _sym[8]
[ 210]    052D: B5 00 B1 0C 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],12
                E2 F6                               
[ 211]    053B: 8A 16 B0 00 B4 02 CD 21               printc         _sym[10]
[ 212]    0543: B5 00 B1 15 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],21
                E2 F6                               
[ 213]    0551: 8A 16 A6 00 B4 02 CD 21               printc         _sym[0]
[ 214]        :                                       
[ 215]    0559: B6 0B B2 02 B7 00 B4 02 CD 10         cursor_at      11,2,0
[ 216]    0563: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 217]    056B: B6 0B B2 04 B7 00 B4 02 CD 10         cursor_at      11,4,0
[ 218]    0575: BA E9 00 B4 09 CD 21                  prints         login_frm_text[9]
[ 219]    057C: B6 0B B2 0F B7 00 B4 02 CD 10         cursor_at      11,15,0
[ 220]    0586: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 221]    058E: B6 0B B2 25 B7 00 B4 02 CD 10         cursor_at      11,37,0
[ 222]    0598: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 223]        :                                       
[ 224]    05A0: B6 0C B2 02 B7 00 B4 02 CD 10         cursor_at      12,2,0
[ 225]    05AA: 8A 16 AA 00 B4 02 CD 21               printc         _sym[4]
[ 226]    05B2: B5 00 B1 0C 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],12
                E2 F6                               
[ 227]    05C0: 8A 16 AC 00 B4 02 CD 21               printc         _sym[6]
[ 228]    05C8: B5 00 B1 15 8A 16 AF 00 B4 02 CD 21   printr         _sym[9],21
                E2 F6                               
[ 229]    05D6: 8A 16 A9 00 B4 02 CD 21               printc         _sym[3]
[ 230]        :                                       
[ 231]    05DE: B6 0E B2 06 B7 00 B4 02 CD 10         cursor_at      14,6,0
[ 232]    05E8: BA F2 00 B4 09 CD 21                  prints         login_frm_sel[0]
[ 233]    05EF: B6 0E B2 12 B7 00 B4 02 CD 10         cursor_at      14,18,0
[ 234]    05F9: BA F9 00 B4 09 CD 21                  prints         login_frm_sel[7]
[ 235]        :                                       
[ 236]    0600: B6 17 B2 02 B7 00 B4 02 CD 10         cursor_at      23,2,0
[ 237]    060A: BA ED 01 B4 09 CD 21                  prints         app_version
[ 238]        :                                       
[ 239]        :                                       ; mark the page has been loaded
[ 240]    0611: C6 06 8F 00 01                        mov            page_buffer[0], 1
[ 241]        :                                       
[ 242]        :                                       ; listens to mouse-pos
[ 243]    0616:                                       keep_listening:
[ 244]        :                                       ; get mouse state
[ 245]    0616: E8 2D 04                              call           whereis_mouse
[ 246]        :                                       ; left button click
[ 247]    0619: 83 FB 01                              cmp            bx, 01h
[ 248]    061C: 75 F8                                 jne            keep_listening
[ 249]        :                                       ; passes when left button is pressed
[ 250]        :                                       
[ 251]        :                                       ; form-selected detection
[ 252]    061E: 81 F9 80 00                           cmp            cx, 0080h
[ 253]    0622: 7C 72                                 jnge           menu_selection
[ 254]    0624: 81 F9 26 01                           cmp            cx, 0126H
[ 255]    0628: 7F 6C                                 jnle           menu_selection
[ 256]        :                                       
[ 257]    062A:                                       card_no:
[ 258]    062A: 83 FA 50                              cmp            dx, 0050h
[ 259]    062D: 7F 31                                 jnle           pin_code
[ 260]    062F: 83 FA 48                              cmp            dx, 0048h
[ 261]    0632: 7C 62                                 jnge           menu_selection
[ 262]    0634: B6 09 B2 10 B7 00 B4 02 CD 10         cursor_at      9,16,0
[ 263]    063E: B5 06 B1 07 B4 01 CD 10 BA 27 00 B4   reads          in_card_no
                0A CD 21 33 DB 8A 1E 28 00 C6 47 29 
                24 BA 29 00 B5 32 B4 01 CD 10       
[ 264]    0660:                                       pin_code:
[ 265]    0660: 83 FA 5E                              cmp            dx, 005Eh
[ 266]    0663: 7F 31                                 jnle           menu_selection
[ 267]    0665: 83 FA 59                              cmp            dx, 0059h
[ 268]    0668: 7C 2C                                 jnge           menu_selection
[ 269]    066A: B6 0B B2 10 B7 00 B4 02 CD 10         cursor_at      11,16,0
[ 270]    0674: B5 06 B1 07 B4 01 CD 10 BA 3A 00 B4   reads          in_pin_code
                0A CD 21 33 DB 8A 1E 3B 00 C6 47 3C 
                24 BA 3C 00 B5 32 B4 01 CD 10       
[ 271]        :                                       
[ 272]        :                                       ; ok&cancel menu detection
[ 273]    0696:                                       menu_selection:
[ 274]    0696: 83 FA 6E                              cmp            dx, 006Eh
[ 275]    0699: 7D 03 E9 78 FF                        jnge           keep_listening
[ 276]    069E: 83 FA 75                              cmp            dx, 0075h
[ 277]    06A1: 7E 03 E9 70 FF                        jnle           keep_listening
[ 278]    06A6:                                       cancel_button:
[ 279]    06A6: 81 F9 90 00                           cmp            cx, 0090h
[ 280]    06AA: 7C 0C                                 jnge           ok_button
[ 281]    06AC: 81 F9 DF 00                           cmp            cx, 00DFh
[ 282]    06B0: 7E 03 E9 61 FF                        jnle           keep_listening
[ 283]    06B5: E8 F7 02                              call           sys_exit
[ 284]    06B8:                                       ok_button:
[ 285]    06B8: 83 F9 30                              cmp            cx, 0030h
[ 286]    06BB: 7D 03 E9 56 FF                        jnge           keep_listening
[ 287]    06C0: 83 F9 5F                              cmp            cx, 005Fh
[ 288]    06C3: 7E 03 E9 4E FF                        jnle           keep_listening
[ 289]        :                                       ; returns to check credibility
[ 290]    06C8: C3                                    ret
[ 291]        :                                       login_page ENDP
[ 292]        :                                       
[ 293]        :                                       ;---------------------- MENU PAGE PROC -------------------------;
[ 294]    06C9:                                       menu_page PROC
[ 295]    06C9:                                       menu_start:
[ 296]    06C9: B0 01 B4 05 CD 10                     set_videopage  1
[ 297]        :                                       ; check if page has been loaded
[ 298]    06CF: 80 3E 90 00 01                        cmp            page_buffer[1], 1
[ 299]    06D4: 75 03 E9 1C 01                        je             render_loop
[ 300]    06D9: E8 C5 02                              call           cls
[ 301]        :                                       
[ 302]        :                                       ; al=row start
[ 303]    06DC: B3 07                                 mov bl,        07h
[ 304]    06DE: B1 03                                 mov cl,        03h
[ 305]        :                                       ; print the selection box
[ 306]    06E0:                                       create_block:
[ 307]        :                                       ; creates block
[ 308]    06E0: 8A F3 B2 02 B7 01 B4 02 CD 10         cursor_at      bl,2,1
[ 309]    06EA: BA 37 01 B4 09 CD 21                  prints         menu_hdr
[ 310]    06F1: 8A F3 B2 14 B7 01 B4 02 CD 10         cursor_at      bl,20,1
[ 311]    06FB: BA 37 01 B4 09 CD 21                  prints         menu_hdr
[ 312]    0702: FE C3                                 inc            bl
[ 313]    0704: 8A F3 B2 02 B7 01 B4 02 CD 10         cursor_at      bl,2,1
[ 314]    070E: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 315]    0716: 8A F3 B2 12 B7 01 B4 02 CD 10         cursor_at      bl,18,1
[ 316]    0720: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 317]    0728: 8A F3 B2 14 B7 01 B4 02 CD 10         cursor_at      bl,20,1
[ 318]    0732: 8A 16 A7 00 B4 02 CD 21               printc        _sym[1]
[ 319]    073A: 8A F3 B2 24 B7 01 B4 02 CD 10         cursor_at      bl,36,1
[ 320]    0744: 8A 16 A7 00 B4 02 CD 21               printc         _sym[1]
[ 321]    074C: FE C3                                 inc            bl
[ 322]    074E: 8A F3 B2 02 B7 01 B4 02 CD 10         cursor_at      bl,2,1
[ 323]    0758: BA 49 01 B4 09 CD 21                  prints         menu_frm_ftr
[ 324]    075F: 8A F3 B2 14 B7 01 B4 02 CD 10         cursor_at      bl,20,1
[ 325]    0769: BA 49 01 B4 09 CD 21                  prints         menu_frm_ftr
[ 326]    0770: 80 C3 02                              add            bl, 2
[ 327]    0773: 49 E3 03 E9 67 FF                     loop           create_block
[ 328]        :                                       
[ 329]        :                                       ; withdraw-text
[ 330]    0779: B6 08 B2 06 B7 01 B4 02 CD 10         cursor_at      8,6,1
[ 331]    0783: BA 04 01 B4 09 CD 21                  prints         menu_frm_text[0]
[ 332]        :                                       ; deposit-text
[ 333]    078A: B6 08 B2 19 B7 01 B4 02 CD 10         cursor_at      8,25,1
[ 334]    0794: BA 0D 01 B4 09 CD 21                  prints         menu_frm_text[9]
[ 335]        :                                       ; balance-text
[ 336]    079B: B6 0C B2 07 B7 01 B4 02 CD 10         cursor_at      12,7,1
[ 337]    07A5: BA 15 01 B4 09 CD 21                  prints         menu_frm_text[17]
[ 338]        :                                       ; reset-pin text
[ 339]    07AC: B6 0C B2 18 B7 01 B4 02 CD 10         cursor_at      12,24,1
[ 340]    07B6: BA 1D 01 B4 09 CD 21                  prints         menu_frm_text[25]
[ 341]        :                                       ; log-out text
[ 342]    07BD: B6 10 B2 07 B7 01 B4 02 CD 10         cursor_at      16,7,1
[ 343]    07C7: BA 27 01 B4 09 CD 21                  prints         menu_frm_text[35]
[ 344]        :                                       ; details text
[ 345]    07CE: B6 10 B2 19 B7 01 B4 02 CD 10         cursor_at      16,25,1
[ 346]    07D8: BA 2F 01 B4 09 CD 21                  prints         menu_frm_text[43]
[ 347]        :                                       
[ 348]        :                                       ; prints time (text)
[ 349]    07DF: B6 04 B2 02 B7 01 B4 02 CD 10         cursor_at      4,2,1
[ 350]    07E9: BA 97 00 B4 09 CD 21                  prints         time
[ 351]        :                                       
[ 352]        :                                       ; mark the page has been loaded
[ 353]    07F0: C6 06 90 00 01                        mov            page_buffer[1], 1
[ 354]    07F5:                                       render_loop:
[ 355]        :                                       ; time printing
[ 356]    07F5: BB 9D 00                              lea            bx,timestamp
[ 357]    07F8: E8 D3 01                              call           get_time
[ 358]    07FB: B6 02 B2 02 B7 01 B4 02 CD 10         cursor_at      2,2,1
[ 359]    0805: BA BF 00 B4 09 CD 21                  prints         login_desc
[ 360]        :                                       
[ 361]    080C: B6 04 B2 08 B7 01 B4 02 CD 10         cursor_at      4,8,1
[ 362]    0816: BA 9D 00 B4 09 CD 21                  prints         timestamp
[ 363]        :                                       
[ 364]    081D: E8 26 02                              call           whereis_mouse
[ 365]    0820: 83 FB 01                              cmp            bx, 0001h
[ 366]    0823: 75 D0                                 jne            render_loop
[ 367]    0825:                                       col_1:
[ 368]        :                                       ; checks if mouse coor is in first column
[ 369]    0825: 83 F9 18                              cmp            cx, 0018h
[ 370]    0828: 7C CB                                 jnge           render_loop
[ 371]    082A: 81 F9 8F 00                           cmp            cx, 008Fh
[ 372]        :                                       ; if not, check if it is in second column
[ 373]    082E: 7E 03 E9 82 00                        jnle           col_2
[ 374]    0833:                                       btn_withdraw:
[ 375]    0833: 83 FA 40                              cmp            dx, 0040h
[ 376]    0836: 7C BD                                 jnge           render_loop
[ 377]    0838: 83 FA 47                              cmp            dx, 0047h
[ 378]    083B: 7F 25                                 jnle           btn_balance
[ 379]    083D: B6 08 B2 03 B7 01 B4 02 CD 10         cursor_at      8,3,1
[ 380]    0847: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 381]        :                                       ; PROCESS: withdraw
[ 382]        :                                       ; withdraw process
[ 383]    084F: E8 D5 00                              call           input_page
[ 384]    0852: B1 00 8A 2E 4D 00 33 C0 2C 30 50 E2   withdrawable   input_amount, ff_balance
                F9                                  
[ 385]        :                                       ; ENDPRC
[ 386]        :                                       ; go back to menu
[ 387]    085F: E9 67 FE                              jmp            menu_start
[ 388]    0862:                                       btn_balance:
[ 389]    0862: 83 FA 60                              cmp            dx, 0060h
[ 390]    0865: 7C 8E                                 jnge           render_loop
[ 391]    0867: 83 FA 67                              cmp            dx, 0067h
[ 392]    086A: 7F 15                                 jnle           btn_logout
[ 393]    086C: B6 0C B2 03 B7 01 B4 02 CD 10         cursor_at      12,3,1
[ 394]    0876: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 395]        :                                       ; PROCESS: balance
[ 396]        :                                       ; ENDPRC
[ 397]    087E: E9 74 FF                              jmp            render_loop
[ 398]    0881:                                       btn_logout:
[ 399]    0881: 81 FA 80 00                           cmp            dx, 0080h
[ 400]    0885: 7D 03 E9 6B FF                        jnge           render_loop
[ 401]    088A: 81 FA 87 00                           cmp            dx, 0087h
[ 402]    088E: 7E 03 E9 62 FF                        jnle           render_loop
[ 403]    0893: B6 10 B2 03 B7 01 B4 02 CD 10         cursor_at      16,3,1
[ 404]    089D: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 405]        :                                       ; PROCESS: logout
[ 406]        :                                       ; sets all significant data to invalid state
[ 407]    08A5: C6 06 29 00 24                        mov            in_card_no[2], '$'
[ 408]    08AA: C6 06 3C 00 24                        mov            in_pin_code[2], '$'
[ 409]    08AF: C6 06 00 00 00                        mov            acct_login[0], 00h
[ 410]        :                                       ; ENDPRC
[ 411]        :                                       ; returns to main PROC
[ 412]    08B4: C3                                    ret
[ 413]    08B5:                                       col_2:
[ 414]    08B5:                                       btn_deposit:
[ 415]    08B5: 83 FA 40                              cmp            dx, 0040h
[ 416]    08B8: 7D 03 E9 38 FF                        jnge           render_loop
[ 417]    08BD: 83 FA 47                              cmp            dx, 0047h
[ 418]    08C0: 7F 15                                 jnle           btn_reset_pin
[ 419]    08C2: B6 08 B2 15 B7 01 B4 02 CD 10         cursor_at      8,21,1
[ 420]    08CC: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 421]    08D4: E9 1E FF                              jmp            render_loop
[ 422]    08D7:                                       btn_reset_pin:
[ 423]    08D7: 83 FA 60                              cmp            dx, 0060h
[ 424]    08DA: 7D 03 E9 16 FF                        jnge           render_loop
[ 425]    08DF: 83 FA 67                              cmp            dx, 0067h
[ 426]    08E2: 7F 18                                 jnle           btn_details
[ 427]    08E4: B6 0C B2 15 B7 01 B4 02 CD 10         cursor_at      12,21,1
[ 428]    08EE: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 429]        :                                       ; PROCESS: reset pin
[ 430]    08F6: E8 2E 00                              call           input_page
[ 431]        :                                       ; TODO
[ 432]        :                                       ; ENDPRC
[ 433]    08F9: E9 CD FD                              jmp            menu_start
[ 434]    08FC:                                       btn_details:
[ 435]    08FC: 81 FA 80 00                           cmp            dx, 0080h
[ 436]    0900: 7D 03 E9 F0 FE                        jnge           render_loop
[ 437]    0905: 81 FA 87 00                           cmp            dx, 0087h
[ 438]    0909: 7E 03 E9 E7 FE                        jnle           render_loop
[ 439]    090E: B6 10 B2 15 B7 01 B4 02 CD 10         cursor_at      16,21,1
[ 440]    0918: 8A 16 B1 00 B4 02 CD 21               printc         _sym[11]
[ 441]    0920: E9 D2 FE                              jmp            render_loop
[ 442]    0923: E9 CF FE                              jmp            render_loop
[ 443]    0926: C3                                    ret
[ 444]        :                                       menu_page ENDP
[ 445]        :                                       
[ 446]        :                                       ;---------------------- INPUT PAGE PROC -------------------------;
[ 447]    0927:                                       input_page PROC
[ 448]    0927: B0 02 B4 05 CD 10                     set_videopage  2
[ 449]        :                                       ; check if page has been loaded
[ 450]    092D: 80 3E 91 00 01                        cmp            page_buffer[2], 1
[ 451]    0932: 74 4A                                 je             input_read
[ 452]    0934: E8 6A 00                              call           cls
[ 453]    0937: B6 09 B2 0B B7 02 B4 02 CD 10         cursor_at      9,11,2
[ 454]    0941: BA A4 01 B4 09 CD 21                  prints         input_text
[ 455]    0948: B6 0C B2 0B B7 02 B4 02 CD 10         cursor_at      12,11,2
[ 456]    0952: B5 00 B1 0C B2 2D B4 02 CD 21 E2 F8   printr         '-',12d
                                                    
[ 457]    095E: B6 0F B2 01 B7 02 B4 02 CD 10         cursor_at      15,1,2
[ 458]    0968: BA B2 01 B4 09 CD 21                  prints         input_note
[ 459]    096F: B6 0B B2 0B B7 02 B4 02 CD 10         cursor_at      11,11,2
[ 460]    0979: C6 06 91 00 01                        mov            page_buffer[2], 1
[ 461]    097E:                                       input_read:
[ 462]    097E: B5 06 B1 07 B4 01 CD 10 BA 4C 00 B4   reads          input_amount
                0A CD 21 33 DB 8A 1E 4D 00 C6 47 4E 
                24 BA 4E 00 B5 32 B4 01 CD 10       
[ 463]    09A0: C3                                    ret
[ 464]        :                                       input_page ENDP
[ 465]        :                                       
[ 466]        :                                       ;---------------------- CLEAR PROC -------------------------;
[ 467]    09A1:                                       cls PROC
[ 468]    09A1: 32 C0                                 xor            al, al
[ 469]    09A3: 33 C9                                 xor            cx, cx
[ 470]    09A5: BA 4F 18                              mov            dx, 184fh
[ 471]    09A8: B7 1E                                 mov            bh, 1eh
[ 472]    09AA: B4 06                                 mov            ah, 06h
[ 473]    09AC: CD 10                                 int            10h
[ 474]    09AE: C3                                    ret
[ 475]        :                                       cls ENDP
[ 476]        :                                       
[ 477]        :                                       ;---------------------- EXIT PROC -------------------------;
[ 478]    09AF:                                       sys_exit PROC
[ 479]    09AF: B6 0B B2 0B B7 06 B4 02 CD 10         cursor_at      11,11,6
[ 480]    09B9: B0 06 B4 05 CD 10 E8 DF FF BA D9 01   alert          exit_msg
                B4 09 CD 21                         
[ 481]        :                                       ; DOS Exit
[ 482]    09C9: B4 4C                                 mov            ah, 4ch
[ 483]    09CB: CD 21                                 int            21h
[ 484]    09CD: C3                                    ret
[ 485]        :                                       sys_exit ENDP
[ 486]        :                                       
[ 487]        :                                       ;---------------------- GET TIME PROC -------------------------;
[ 488]    09CE:                                       get_time PROC
[ 489]        :                                       ; input  : BX=offset address of the string TIME
[ 490]        :                                       ; output : BX=current time
[ 491]        :                                       ; get current system time
[ 492]    09CE: B4 2C                                 mov            ah, 2ch
[ 493]    09D0: CD 21                                 int            21h
[ 494]        :                                       
[ 495]        :                                       ; ch=hours
[ 496]    09D2: 8A C5                                 mov            al, ch
[ 497]    09D4: E8 13 00                              call           to_ascii
[ 498]    09D7: 89 07                                 mov            [bx], ax
[ 499]        :                                       
[ 500]        :                                       ; cl=minutes
[ 501]    09D9: 8A C1                                 mov            al, cl
[ 502]    09DB: E8 0C 00                              call           to_ascii
[ 503]    09DE: 89 47 03                              mov            [bx+3], ax
[ 504]        :                                       ; dh=seconds
[ 505]    09E1: 8A C6                                 mov            al, dh
[ 506]    09E3: E8 04 00                              call           to_ascii
[ 507]    09E6: 89 47 06                              mov            [bx+6], ax
[ 508]    09E9: C3                                    ret
[ 509]        :                                       get_time ENDP
[ 510]        :                                       
[ 511]        :                                       ;---------------------- TO ASCII PROC -------------------------;
[ 512]    09EA:                                       to_ascii PROC
[ 513]        :                                       ; input  : AL=binary code
[ 514]        :                                       ; output : AX=ASCII code
[ 515]    09EA: B4 00                                 mov            ah, 00h
[ 516]    09EC: B2 0A                                 mov            dl, 10d
[ 517]    09EE: F6 F2                                 div            dl
[ 518]    09F0: 0D 30 30                              or             ax, 3030H
[ 519]    09F3: C3                                    ret
[ 520]        :                                       to_ascii ENDP
[ 521]        :                                       
[ 522]        :                                       ;---------------------- VALIDATE ACCOUNT PROC -------------------------;
[ 523]    09F4:                                       validate_acct PROC
[ 524]        :                                       ; compare card_no
[ 525]    09F4: BE 01 00                              lea            si, ff_card_no
[ 526]    09F7: BF 29 00                              lea            di, [in_card_no+2]
[ 527]    09FA: 33 C9                                 xor            cx, cx
[ 528]    09FC: B9 10 00                              mov            cx, 10h
[ 529]    09FF: 8A 04                                 mov            al, [si]
[ 530]    0A01: 8A 1D                                 mov            bl, [di]
[ 531]    0A03: 3A C3                                 cmp            al, bl
[ 532]    0A05: 75 21                                 jne            str_notequal
[ 533]    0A07: F3 A6                                 repe cmpsb
[ 534]    0A09: 75 1D                                 jne            str_notequal
[ 535]        :                                       ; compare pin_code
[ 536]    0A0B: BE 12 00                              lea            si, ff_pin_code
[ 537]    0A0E: BF 3C 00                              lea            di, [in_pin_code+2]
[ 538]    0A11: 33 C9                                 xor            cx, cx
[ 539]    0A13: B9 06 00                              mov            cx, 06h
[ 540]    0A16: 8A 04                                 mov            al, [si]
[ 541]    0A18: 8A 1D                                 mov            bl, [di]
[ 542]    0A1A: 3A C3                                 cmp            al, bl
[ 543]    0A1C: 75 0A                                 jne            str_notequal
[ 544]    0A1E: F3 A6                                 repe cmpsb
[ 545]    0A20: 75 06                                 jne            str_notequal
[ 546]        :                                       ; equal
[ 547]    0A22: C6 06 00 00 01                        mov            acct_login[0], 01h
[ 548]    0A27: C3                                    ret
[ 549]    0A28:                                       str_notequal:
[ 550]    0A28: B6 0A B2 0A B7 06 B4 02 CD 10         cursor_at      10,10,6
[ 551]    0A32: B0 06 B4 05 CD 10 E8 66 FF BA 6B 01   alert          err_incorrect
                B4 09 CD 21                         
[ 552]    0A42: E8 07 00                              call           delay
[ 553]    0A45: C3                                    ret
[ 554]        :                                       validate_acct ENDP
[ 555]        :                                       
[ 556]        :                                       ;---------------------- GET MOUSE COORDINATE PROC -------------------------;
[ 557]    0A46:                                       whereis_mouse PROC
[ 558]    0A46: B8 03 00                              mov            ax, 03h
[ 559]    0A49: CD 33                                 int            33h
[ 560]    0A4B: C3                                    ret
[ 561]        :                                       ENDP
[ 562]        :                                       
[ 563]        :                                       ;---------------------- DELAY PROC -------------------------;
[ 564]        :                                       ; one second delay
[ 565]    0A4C:                                       delay PROC
[ 566]    0A4C: B0 00                                 mov            al, 00h
[ 567]    0A4E: B9 0F 00                              mov            cx, 0Fh
[ 568]    0A51: BA 40 42                              mov            dx, 4240h
[ 569]    0A54: B4 86                                 mov            ah, 86h
[ 570]    0A56: CD 15                                 int            15h
[ 571]    0A58: C3                                    ret
[ 572]        :                                       ENDP
[ 573]        :                                       END main
[ 574]        :                                       
 
===================================================================================================
 
EXE HEADER - bytes from 0000 to 01FF inclusive.

0000: 4D      -   exe signature (M)
0001: 5A      -   exe signature (Z)
0002: 59      -   bytes on last page (l.byte)
0003: 00      -   bytes on last page (h.byte)
0004: 07      -   512 byte pages in file (l.byte)
0005: 00      -   512 byte pages in file (h.byte)
0006: 01      -   relocations (l.byte)
0007: 00      -   relocations (h.byte)
0008: 20      -   paragraphs in header (l.byte)
0009: 00      -   paragraphs in header (h.byte)
000A: 00      -   minimum memory (l.byte)
000B: 00      -   minimum memory (h.byte)
000C: FF      -   maximum memory (l.byte)
000D: FF      -   maximum memory (h.byte)
000E: 00      -   SS - stack segment (l.byte)
000F: 00      -   SS - stack segment (h.byte)
0010: 00      -   SP - stack pointer (l.byte)
0011: 01      -   SP - stack pointer (h.byte)
0012: AA      -   check sum (l.byte)
0013: 9B      -   check sum (h.byte)
0014: 00      -   IP - instruction pointer (l.byte)
0015: 00      -   IP - instruction pointer (h.byte)
0016: 31      -   CS - code segment (l.byte)
0017: 00      -   CS - code segment (h.byte)
0018: 1E      -   relocation table adress (l.byte)
0019: 00      -   relocation table adress (h.byte)
001A: 00      -   overlay number (l.byte)
001B: 00      -   overlay number (h.byte)
001C: 01      -   signature (l.byte)
001D: 00      -   signature (h.byte)
001E: 45      -   relocation table - offset inside segment (l.byte)
001F: 00      -   relocation table - offset inside segment (h.byte)
0020: 31      -   relocation table - segment anchor (l.byte)
0021: 00      -   relocation table - segment anchor (h.byte)
0022 to 01FF  -   reserved relocation area  (00) 




===================================================================================================
